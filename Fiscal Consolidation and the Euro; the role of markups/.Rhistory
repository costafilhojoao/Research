# clear data & close graphs
rm(list = ls())  # clear the memory
set.seed(12345)  # set the seed
# clear data & close graphs
rm(list = ls())  # clear the memory
graphics.off()
setwd("C:/Users/jcfil/Google Drive/Documents/Papers/Acadêmicos/Research/Fiscal Consolidation and the Euro; the role of markups")
library(haven)
micro  <- read_dta(file = "agggregate_mkups_by_sector.dta")
View(micro)
micro$mkup_growth * 100
getwd()
load("markupsdata.RData")
View(sectoral_mu)
View(markups_sector)
setwd("C:/Users/jcfil/Google Drive/Documents/Papers/Acadêmicos/Research/Fiscal Consolidation and the Euro; the role of markups")
library(haven)
micro  <- read_dta(file = "agggregate_mkups_by_sector.dta")
library(nicethings)
nice_load(file = "markupsdata.RData", object = c("nace", "sectors", "markups_sector"), rename = NULL)
markups_sector <- markups_sector[["Portugal"]]
nice_load(file = "markupsdata.RData", object = c("nace", "sector", "markups_sector"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("nace", "sector", "markups_sector"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("nace", "sector", "markups_sector"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("nace", "sector", "markups_sector"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("nace", "sector", "markups_sector"), rename = NULL)
load("markupsdata.RData")
nice_load(file = "markupsdata.RData", object = c("nace"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("nace"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("sectors"), rename = NULL)
nice_load(file = "markupsdata.RData", object = c("markups_sector"), rename = NULL)
markups_sector <- markups_sector[["Portugal"]]
View(markups_sector)
library(tempdisagg)
View(markups_sector)
micro  <- read_dta(file = "agggregate_mkups_by_sector.dta")
View(micro)
View(micro)
View(micro)
colnames(micro) <- c("year", "nace", "markup", "shock")
View(micro)
?replace
View(markups_sector)
micro_mkp <- matrix( data = NA,
nrow = nrow( markups_sector ),
ncol = ncol( markups_sector))
View(micro)
micro_mkp <- matrix( data = NA,
nrow = 11,
ncol = ncol( markups_sector))
View(micro_mkp)
rownames( micro_mkp ) <- seq( 2004, 2014)
View(micro_mkp)
micro_mkp[1,] <- rep( 100, ncol(micro_mkp) )
View(micro_mkp)
View(micro_mkp)
colnames( micro_mkp ) <- sectors
View(micro_mkp)
m <-  subset( micro, nace == "A" )
View(m)
View(micro)
colnames(micro) <- c("year", "nace", "markup", "shock")
View(micro)
View(markups_sector)
View(m)
m$markup[2]
micro_mkp[2,1] < - micro_mkp[1,1] * ( 1 + m$markup[2] )
View(micro_mkp)
micro_mkp[2,1]
micro_mkp[1,1] * ( 1 + m$markup[2] )
micro_mkp[2,1]
micro_mkp[2,1] < - micro_mkp[1,1] * ( 1 + m$markup[2] )
View(micro_mkp)
micro_mkp[2,1] < - micro_mkp[1,1] * ( 1 + m$markup[2] )
m <-  subset( micro, nace == "A" )
micro_mkp[2,1] < - micro_mkp[1,1] * ( 1 + m$markup[2] )
micro_mkp[2,1] < - 101
View(micro_mkp)
rm(m)
m <- subset( micro, nace == "A" )
micro_mkp[ 2, 1 ] < - 101
View(micro_mkp)
micro_mkp[1]
micro_mkp[2]
micro_mkp[1,2]
micro_mkp[1,1]
micro_mkp[2,1]
micro_mkp[ 2, 1 ] <- 101
View(micro_mkp)
micro_mkp[ 2, 1 ] <- micro_mkp[1,1] * ( 1 + m$markup[2] )
View(micro_mkp)
micro[micro == "."] <- "K"
View(micro)
for (j  in 1:length(nace)) {
for (t  in nrow( micro_mkp )) {
m <- subset( micro, nace == nace[j] )
micro_mkp[ t+1, j ] <- micro_mkp[t,j] * ( 1 + m$markup[t+1] )
}
}
View(micro_mkp)
j = t = 2
m <- subset( micro, nace == nace[j] )
View(m)
nace[j]
m <- subset( micro, nace == nace[j] )
View(m)
rm(m)
m <- subset( micro, nace == nace[j] )
View(m)
nace[j]
m <- subset( micro, nace == nace[j] )
View(m)
micro$nace
View(micro)
m <- subset( micro, nace == nace[j] )
View(m)
j=3
m <- subset( micro, nace == nace[j] )
View(m)
nace[j]
m <- subset( micro, nace == nace[j-1] )
View(m)
micro_mkp[ t+1, j ] <- micro_mkp[t,j] * ( 1 + m$markup[t+1] )
View(m)
for (j  in 1:length(nace)) {
for (t  in nrow( micro_mkp )) {
m <- subset( micro, nace == nace[j-1] )
micro_mkp[ t+1, j ] <- micro_mkp[t,j] * ( 1 + m$markup[t+1] )
}
}
View(micro_mkp)
micro_mkp <- matrix( data = NA,
nrow = 11,
ncol = ncol( markups_sector))
rownames( micro_mkp ) <- seq( 2004, 2014)
colnames( micro_mkp ) <- sectors
micro_mkp[1,] <- rep( 100, ncol(micro_mkp) )
View(micro_mkp)
j = t = 1
rm(m)
m <- subset( micro, nace == nace[j-1] )
j = 1
t = 2
m <- subset( micro, nace == nace[j-1] )
m <- subset( micro, nace == nace[j] )
View(m)
View(m)
?sort
sort(micro$nace)
View(micro)
m <- subset( micro, nace == "A" )
View(m)
micro_mkp[ t+1, j ] <- micro_mkp[t,j] * ( 1 + m$markup[t+1] )
View(micro_mkp)
View(micro_mkp)
micro_mkp[ t+1, j ] <- micro_mkp[t,j] * ( 1 + m$markup[t+1] )
micro_mkp[ t+1, j ]
micro_mkp[t,j] * ( 1 + m$markup[t+1] )
micro_mkp[t,j]
micro_mkp[t-1,j]
micro_mkp[ t+1, j ] <- micro_mkp[t-1,j] * ( 1 + m$markup[t+1] )
View(micro_mkp)
( 1 + m$markup[t+1] )
m$markup[t+1]
View(m)
micro_mkp[t-1,j]
micro_mkp[t-1,j] * ( 1 + m$markup[t] )
micro_mkp[ t+1, j ]
micro_mkp[ t, j ] <- micro_mkp[t-1,j] * ( 1 + m$markup[t] )
View(micro_mkp)
for (t  in 2:nrow( micro_mkp )) {
m <- subset( micro, nace == "A" )
micro_mkp[ t, j ] <- micro_mkp[t-1,j] * ( 1 + m$markup[t] )
}
View(micro_mkp)
n <- nace[j]
m <- subset( micro, nace == n )
View(m)
for (j  in 1:length(nace)) {
for (t  in 2:nrow( micro_mkp )) {
n <- nace[j]
m <- subset( micro, nace == n )
micro_mkp[ t, j ] <- micro_mkp[t-1,j] * ( 1 + m$markup[t] )
}
}
View(micro_mkp)
View(micro)
4.576174e-03
rm(n, m, i, j)
rm(n, m, i, t)
markups_sector_q <- markups_sector
markups_sector_q <- NA
markups_sector_q <- markups_sector
mu_a_j  <- ts( micro_mkp[,1], start = 2004, frequency = 1 )
View(mu_a_j)
plot(mu_a_j)
j = 1
mu_a_j  <- ts( micro_mkp[ , j ], start = 2004, frequency = 1 )
View(markups_sector)
mu_q_j  <- ts( markups_sector[ , j ], start = c( 1995, 1), frequency = 4 )
plot(mu_q_j)
mu <- td( mu_a_j ~ 0 + mu_q_j,
to = "quarterly", method = "denton-cholette" )
mu <- predict(mu)
plot(mu)
mu
mu_a_j  <- ts( micro_mkp[ , j ] * 4, start = 2004, frequency = 1 )
mu_q_j  <- ts( markups_sector[ , j ], start = c( 1995, 1), frequency = 4 )
mu <- td( mu_a_j ~ 0 + mu_q_j,
to = "quarterly", method = "denton-cholette" )
mu <- predict(mu)
plot(mu)
markups_sector_q[j,] <- predict(mu)
mu <- td( mu_a_j ~ 0 + mu_q_j,
to = "quarterly", method = "denton-cholette" )
markups_sector_q[j,] <- predict(mu)
mu <- predict(mu)
markups_sector_q[ , j ] <- predict(mu)
markups_sector_q[ , j ] <- mu
View(markups_sector_q)
for (j  in 1:length(nace)) {
mu_a_j  <- ts( micro_mkp[ , j ] * 4, start = 2004, frequency = 1 )
mu_q_j  <- ts( markups_sector[ , j ], start = c( 1995, 1), frequency = 4 )
mu <- td( mu_a_j ~ 0 + mu_q_j,
to = "quarterly", method = "denton-cholette" )
mu <- predict(mu)
markups_sector_q[ , j ] <- mu
}
View(markups_sector_q)
rm(j, mu_a_j, mu_q_j, mu)
save.image("C:/Users/jcfil/Google Drive/Documents/Papers/Acadêmicos/Research/Fiscal Consolidation and the Euro; the role of markups/sectorsdata.RData")
load("sectorsdata.RData")
recessions = read.table(textConnection( #it does not include the two previous recessions
"Peak, Trough
2002-03-01, 2003-06-01
2008-03-01, 2009-03-01
2010-09-01, 2013-03-01"), sep=',',
colClasses=c('Date', 'Date'), header=TRUE)
dates  <- seq(as.Date('1995-03-01'), as.Date('2019-12-01'), by='quarter')
j = 1
data <- data.frame( mu = markups_sector_q[ , j ] , dates )
View(data)
ggplot(data) + geom_line(aes(x = dates, y =  mu ), size = 0.8) +
theme_bw() +
geom_rect(data=recessions, aes(xmin=Peak,
xmax=Trough, ymin=-Inf, ymax=+Inf), fill='gray', alpha=0.2) +
labs(x = "") + ylab( TeX( "$\\mu$" ) ) + theme(aspect.ratio=1) +
#  ggtitle( countries_names[ i ] ) +
theme(plot.title = element_text( hjust = 0.5) ) + theme(text = element_text(size=24) )
}
library(ggplot2)
ggplot(data) + geom_line(aes(x = dates, y =  mu ), size = 0.8) +
theme_bw() +
geom_rect(data=recessions, aes(xmin=Peak,
xmax=Trough, ymin=-Inf, ymax=+Inf), fill='gray', alpha=0.2) +
labs(x = "") + ylab( TeX( "$\\mu^j$" ) ) + theme(aspect.ratio=1) +
#  ggtitle( countries_names[ i ] ) +
theme(plot.title = element_text( hjust = 0.5) ) + theme(text = element_text(size=24) )
library(latex2exp)
ggplot(data) + geom_line(aes(x = dates, y =  mu ), size = 0.8) +
theme_bw() +
geom_rect(data=recessions, aes(xmin=Peak,
xmax=Trough, ymin=-Inf, ymax=+Inf), fill='gray', alpha=0.2) +
labs(x = "") + ylab( TeX( "$\\mu^j$" ) ) + theme(aspect.ratio=1) +
#  ggtitle( countries_names[ i ] ) +
theme(plot.title = element_text( hjust = 0.5) ) + theme(text = element_text(size=24) )
ggplot(data) + geom_line(aes(x = dates, y =  mu ), size = 0.8) +
theme_bw() +
geom_rect(data=recessions, aes(xmin=Peak,
xmax=Trough, ymin=-Inf, ymax=+Inf), fill='gray', alpha=0.2) +
labs(x = "") + ylab( TeX( "$\\mu^j$" ) ) + theme(aspect.ratio=1) +
ggtitle( sectors[ j ] ) +
theme(plot.title = element_text( hjust = 0.5) ) + theme(text = element_text(size=24) )
rm(j)
View(markups_sector_q)
View(markups_sector)
View(markups_sector_q)
View(dates)
dates[61:76]
markups_sector_q[ , j ][61:76]
j=1
markups_sector_q[ , j ][61:76]
markups_sector_q[ , j ][61:76]
data <- data.frame( mu = markups_sector_q[ , j ][61:76] , dates[61:76] )
View(data)
dates[61:76]
dates
nice_load(file = "markupsdata.RData", object = c("weights"), rename = NULL)
markups_weights <- weights / markups_sector_q
mu <- matrix( data = syear:eyear,
nrow = ( eyear - syear + 1 ) * 4,
ncol = 1 )
mu <- matrix( data = syear:eyear,
nrow = ( eyear - syear + 1 ) * 4,
ncol = 1 )
syear   <- 1995  #start year
eyear   <- 2019  #end year
mu <- matrix( data = syear:eyear,
nrow = ( eyear - syear + 1 ) * 4,
ncol = 1 )
rm(mu)
mu_micro <- matrix( data = syear:eyear,
nrow = ( eyear - syear + 1 ) * 4,
ncol = 1 )
#aggregate markup
for (t in 1:nrow( mu )){
mu[t]  <- 1 / sum ( markups_weights[ t, ] )
}
#aggregate markup
for (t in 1:nrow( mu_micro )){
mu_micro[t]  <- 1 / sum ( markups_weights[ t, ] )
}
plot(mu_micro)
contribution_matrix <- matrix(NA,
nrow = nrow( markups_sector_q ),
ncol = length( markups_sector_q ) )
nrow( markups_sector_q
nrow( markups_sector_q )
nrow( markups_sector_q )
contribution_matrix <- matrix(NA,
nrow = nrow( markups_sector_q ),
ncol = ncol( markups_sector_q ) )
colnames( contribution_matrix ) <- sectors
for ( j in 1:length( sectors ) ) {
for ( t in 1:nrow( contribution_matrix ) ) {
contribution_matrix[ t, j ] <- ( markups_weights[ t , j ] / sum( markups_weights[ t , ] ) ) * 10
}
}
rm(t,j)
View(contribution_matrix)
for ( j in 1:length( sectors ) ) {
for ( t in 1:nrow( contribution_matrix ) ) {
contribution_matrix[ t, j ] <- ( markups_weights[ t , j ] / sum( markups_weights[ t , ] ) ) * 100
}
}
View(contribution_matrix)
rm(t,j)
contribution_crisis <- matrix( data = NA, nrow = length( sectors ), ncol = 3)
colnames(contribution_sum) <- c("Sector", "Mean", "Standard Deviation")
colnames(contribution_crisis) <- c("Sector", "Mean", "Standard Deviation")
contribution_crisis[,1]     <- sectors
View(contribution_crisis)
j=1
contribution[63:73,j]
contribution_matrix[63:73,j]
round( mean( contribution_matrix[63:73,j] ), 2)
for (j in 1:nrow( contribution_crisis )) {
contribution_crisis[j,2] <- round( mean( contribution_matrix[63:73,j] ), 2 )
contribution_crisis[j,3] <- round( sd( contribution[[i]][63:73,j] ), 2 )
}
contribution <- matrix(NA,
nrow = nrow( markups_sector_q ),
ncol = ncol( markups_sector_q ) )
colnames( contribution_matrix ) <- sectors
for ( j in 1:length( sectors ) ) {
for ( t in 1:nrow( contribution ) ) {
contribution[ t, j ] <- ( markups_weights[ t , j ] / sum( markups_weights[ t , ] ) ) * 100
}
}
rm(t,j)
View(dates)
for (j in 1:nrow( contribution_crisis )) {
contribution_crisis[j,2] <- round( mean( contribution[63:76,j] ), 2 )
contribution_crisis[j,3] <- round( sd( contribution[[i]][63:76,j] ), 2 )
}
View(contribution_crisis)
for (j in 1:nrow( contribution_crisis )) {
contribution_crisis[j,2] <- round( mean( contribution[63:76,j] ), 2 )
contribution_crisis[j,3] <- round( sd( contribution[63:76,j] ), 2 )
}
rm(j)
View(contribution)
View(contribution_crisis)
sum(contribution_crisis[,2])
contribution_crisis
contribution_crisis[2]
contribution_crisis[,2]
save.image("C:/Users/jcfil/Google Drive/Documents/Papers/Acadêmicos/Research/Fiscal Consolidation and the Euro; the role of markups/sectorsdata.RData")
kable(contribution_crisis,
format = "latex",
booktabs = TRUE)
kable(contribution_crisis,
format = "latex",
booktabs = TRUE)
library(kableExtra)
library(kableExtra)
kable(contribution_crisis[["Portugal"]],
format = "latex",
booktabs = TRUE)
kable(contribution_crisis,
format = "latex",
booktabs = TRUE)
save.image("C:/Users/jcfil/Google Drive/Documents/Papers/Acadêmicos/Research/Fiscal Consolidation and the Euro; the role of markups/sectorsdata.RData")
