plot(impulse.response, scales = 'free_y')
?imrf
impulse.response <- irf(structural.form, horizon = 30)
plot(impulse.response, scales = 'free_y')
structural.form$B
structural.form$A
structural.form$B <- Bmat
impulse.response <- irf(structural.form, horizon = 30)
plot(impulse.response, scales = 'free_y')
cores <- parallel::detectCores() - 1
boot.svar <- wild.boot(structural.form, n.ahead = 30, nboot = 500, nc = cores)
plot(boot.svar)
boot.svar <- wild.boot(structural.form, n.ahead = 12, nboot = 20, nc = cores)
setwd("G:/Meu Drive/Documents/Papers/Acadêmicos/Research/The square root of all evil; The role of market power in fiscal consolidations/SVAR")
rm(list = ls())  # clear the memory
graphics.off()   # close graphs
load("svardata.RData")
library(MTS)
install.packages(VARMA)
install.packages("VARMA")
install.packages("MTS")
library(MTS)
?VARMA
y  <- log( ypc )
g  <- log( gspc )
t  <- log( tpc  )
mu <- log( MU )
d  <- D
r  <- R
pf <- log( window( ts( PM$values, start=c(1995,1), frequency = 4), start = c( 1999, 1), end = c( 2019, 4) )  )
y  <- diff( y )
g  <- diff( g )
t  <- diff( t )
mu <- diff( mu )
d  <- diff( d )
r  <- diff( r )
pf <- diff( pf )
data <- data.frame( g, t, y, mu )
varma <- VARMA( data, p = 2, q = 2, include.mean = F)
View(varma)
library(bvarsv)
set.seed(1301)
fit <- bvar.sv.tvp(data, p = 2)
usmacro
library(bvarsv)
usmacro
data(usmacro)
View(usmacro)
fit <- bvar.sv.tvp( ts( data,start = c( 1999, 1), frequency = 4), p = 2)
l
# Datas no formato "string"
tml <- paste0(floor(time(data)), "Q", (1 + 4*(time(data) - floor(time(data)))))
time(data)
# Datas no formato "string"
tml <- paste0(floor(time(ts( data,start = c( 1999, 1), frequency = 4))),
"Q", (1 + 4*(time(ts( data,start = c( 1999, 1), frequency = 4)) - floor(time(ts( data,start = c( 1999, 1), frequency = 4))))))
# Função para construir os gráficos
matplot2 <- function(x, y, ylim, ...){
matplot(x = x, y = y, ylim = ylim, type = "l", xlab = "", ylab = "",
lty = 1, lwd = 2, bty = "n", ...)
}
abline2 <- function(...){
abline(..., lty = 4, lwd = 0.3)
}
gp <- seq(1965, 2000, 5)
# Cores de http://www.cookbook-r.com/Graphs/Colors_%28ggplot2%29/
cbPalette <- c("#999999", "#E69F00", "#56B4E9", "#009E73", "#F0E442", "#0072B2",
"#D55E00", "#CC79A7")
cols1 <- cbPalette[c(2, 4, 2)]
cols2 <- cbPalette[c(2, 4, 6)]
all_dts <- c("2006Q1", "2008Q3", "2010Q4")
irfs = impulse.responses(fit, impulse.variable = 1, response.variable = 2,
t = NULL, nhor = 20, scenario = 2, draw.plot = TRUE)
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 42
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(yb[1], yb[2], 0.05))
legend(legend_loc, legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(yb[1], yb[2], 0.05))
gp <- seq(1999, 2019, 3)
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = yb, col = cols2, main = plot_title)
matplot2(x = 0:20, y = gdat)
matplot2(x = 0:20, y = gdat, ylim = c(0, 0.8), col = cols2, main = plot_title)
matplot2(x = 0:20, y = gdat, ylim = c(-0.009, 0.008), col = cols2, main = plot_title)
matplot2(x = 0:20, y = gdat, ylim = c(-0.006, 0.002), col = cols2, main = plot_title)
matplot2(x = 0:20, y = gdat, ylim = c(-0.006, 0.002), col = cols2, main = plot_title)
gdat
matplot2(x = 0:20, y = gdat, ylim = c(-0.002, 0.002), col = cols2, main = plot_title)
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
#scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = c(-0.002, 0.002), col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(yb[1], yb[2], 0.05))
matplot2(x = 0:20, y = gdat, ylim = c(-0.002, 0.002), col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
legend(legend_loc, legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
legend( legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
?legend
legend(c(0, -0.004), legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = c(-0.002, 0.002), col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
legend(c(20, 0.004), legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
legend(c(15, 0.004), legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = c(-0.002, 0.002), col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
legend(c(15, 0.004), legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
legend(c(1, 0.004), legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
legend(c(0, 0.004), legend = all_dts, col = cols2, lty = 1, lwd = 2, bty = "n")
tpm
tmp
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = c(-0.002, 0.002), col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
if (rr == 3){
yb <- c(-0.003, 0.002)
} else {
yb <- c(-0.003, 0.002)
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.003, 0.002)
} else {
yb <- c(-0.003, 0.002)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 3,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.003, 0.002)
} else {
yb <- c(-0.003, 0.002)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
?impulse.responses
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.003, 0.002)
} else {
yb <- c(-0.003, 0.002)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:20, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.003, 0.002)
} else {
yb <- c(-0.003, 0.002)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.003, 0.004)
} else {
yb <- c(-0.006, 0.002)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.006, 0.002)
} else {
yb <- c(-0.002, 0.006)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.008, 0.002)
} else {
yb <- c(-0.002, 0.008)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.012, 0.002)
} else {
yb <- c(-0.002, 0.012)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.012, 0.002)
} else {
yb <- c(-0.002, 0.014)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
which(tml == dd)
tml
?impulse.responses
irf_y = impulse.responses(fit, impulse.variable = 1,
response.variable = 3, t = NULL,
scenario = 1, nhor = 12,
draw.plot = FALSE)
View(irf_y)
irf_y[["irf"]]
irf_y[["irf"]]
impulse.responses(fit, impulse.variable = 1,
response.variable = 3, t = NULL,
scenario = 1, nhor = 12,
draw.plot = TRUE)
irf_y = impulse.responses(fit, impulse.variable = 1,
response.variable = 4, t = NULL,
scenario = 1, nhor = 12,
draw.plot = TRUE)$irf
View(irf_y)
impulse.responses(fit, impulse.variable = 1,
response.variable = 4, t = NULL,
scenario = 1, nhor = 12,
draw.plot = TRUE)
impulse.responses(fit, impulse.variable = 1,
response.variable = 4, t = NULL,
scenario = 1, nhor = 12,
draw.plot = TRUE)
impulse.responses(fit, impulse.variable = 1,
response.variable = 3, t = NULL,
scenario = 1, nhor = 12,
draw.plot = TRUE)
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:4){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.012, 0.002)
} else {
yb <- c(-0.002, 0.014)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
# Inflação (rr = 1) desemprego (rr = 2)
for (rr in 3:3){
tmp <- list()
4
for (dd in all_dts){
t <- which(tml == dd) - 22
t_ind <- which(all_dts == dd)
# impulso-resposta
aux <- impulse.responses(fit, impulse.variable = 1,
response.variable = rr, t = t,
scenario = 1, nhor = 12,
draw.plot = FALSE)$irf
tmp[[t_ind]] <- aux
}
gdat <- rbind(0, sapply(tmp, function(z) apply(as.matrix(z), 2, median)))
if (rr == 3){
yb <- c(-0.012, 0.002)
} else {
yb <- c(-0.002, 0.014)
}
plot_title <- paste0("Figure 10, panel (a)")
matplot2(x = 0:12, y = gdat, ylim = yb, col = cols2, main = plot_title)
abline2(v = seq(5, 20, 5), h = seq(-0.002, 0.002, 0.05))
}
usmacro
usmacro
